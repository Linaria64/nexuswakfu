---
import MainLayout from '../../layouts/MainLayout.astro';
import { getCollection } from 'astro:content';
import Modal from '../../components/ui/Modal.astro';
import { Image } from 'astro:assets';

// Importer les images d'aptitude par défaut pour éviter les requêtes multiples
import dpsIcon from '../../assets/images/ability/dps.png';
import tankIcon from '../../assets/images/ability/tank.png';
import controleIcon from '../../assets/images/ability/controle.png';
import healthIcon from '../../assets/images/ability/health.png';
import placementIcon from '../../assets/images/ability/placement.png';
import specialiteIcon from '../../assets/images/ability/specialite.png';
import entraveIcon from '../../assets/images/ability/entrave.png';
import invocationIcon from '../../assets/images/ability/invocation.png';

// Fonction pour récupérer l'icône d'aptitude en fonction du type
const getAbilityIcon = (type: string) => {
  switch (type.toLowerCase()) {
    case 'dps': return dpsIcon;
    case 'tank': return tankIcon;
    case 'controle': return controleIcon;
    case 'soutien': return controleIcon; // Alias pour controle
    case 'health': return healthIcon;
    case 'placement': return placementIcon;
    case 'specialite': return specialiteIcon;
    case 'entrave': return entraveIcon;
    case 'invocation': return invocationIcon;
    default: return dpsIcon;
  }
};

// Fonction pour récupérer la couleur de fond en fonction du type
const getAbilityBgColor = (type: string) => {
  switch (type.toLowerCase()) {
    case 'dps': return 'bg-orange-500/20 hover:bg-orange-500/30';
    case 'tank': return 'bg-blue-500/20 hover:bg-blue-500/30';
    case 'controle': return 'bg-green-500/20 hover:bg-green-500/30';
    case 'soutien': return 'bg-green-500/20 hover:bg-green-500/30'; // Alias pour controle
    case 'health': return 'bg-red-500/20 hover:bg-red-500/30';
    case 'placement': return 'bg-purple-500/20 hover:bg-purple-500/30';
    case 'specialite': return 'bg-amber-500/20 hover:bg-amber-500/30';
    case 'entrave': return 'bg-indigo-500/20 hover:bg-indigo-500/30';
    case 'invocation': return 'bg-teal-500/20 hover:bg-teal-500/30';
    default: return 'bg-gray-500/20 hover:bg-gray-500/30';
  }
};

// Récupérer les classes depuis la collection
const classes = (await getCollection('classes')).sort((a, b) => a.data.name.localeCompare(b.data.name));

// Définir les couleurs pour chaque rôle
const roleColors = {
  'Tank': 'text-blue-300 bg-blue-900/50 border-blue-500/50',
  'Support': 'text-green-300 bg-green-900/50 border-green-500/50',
  'DPT': 'text-red-300 bg-red-900/50 border-red-500/50',
  'DPT distance': 'text-orange-300 bg-orange-900/50 border-orange-500/50',
  'DPT mêlée': 'text-yellow-300 bg-yellow-900/50 border-yellow-500/50',
  'Tank/DPT': 'text-purple-300 bg-purple-900/50 border-purple-500/50',
  'Healer, Support': 'text-emerald-300 bg-emerald-900/50 border-emerald-500/50',
};

---

<MainLayout title="Classes de Wakfu" description="Découvrez toutes les classes jouables dans Wakfu, leurs caractéristiques, spécialités et guides">
  <div class="container mx-auto px-4 py-12">
    <h1 class="text-5xl font-bold mb-4 text-center text-gradient-primary">Les Classes de Wakfu</h1>
    
    <p class="text-lg mb-10 max-w-3xl mx-auto text-center text-[var(--color-text-muted)]">
      Explorez les 18 classes uniques de Wakfu. Découvrez leurs sorts, passifs et styles de jeu pour trouver celle qui vous correspond.
    </p>

    <!-- Liste des classes - Glassmorphism Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12" id="classes-container">
      {classes.map((clazz, index) => {

        const roleStyle = roleColors[clazz.data.role] || 'text-gray-300 bg-gray-700/50 border-gray-500/50';
        const animationDelay = `${index * 0.07}s`;
        
        return (
          <div 
            class="class-card glass rounded-xl overflow-hidden shadow-lg transition-all duration-300 hover:shadow-primary/20 hover:border-[var(--color-border-highlight)] hover:-translate-y-1 animate-fade-up flex flex-col h-full"
            style={`animation-delay: ${animationDelay};`}
          >
            <div class="p-6 relative z-10 flex flex-col h-full">
              {/* En-tête */}
              <div class="flex items-center gap-4 mb-4">
                <Image 
                  src={clazz.data.icon.src} 
                  alt={clazz.data.icon.alt}
                  width={64}
                  height={64}
                  loading={index > 5 ? "lazy" : "eager"}
                  format="webp"
                  class="w-16 h-16 rounded-lg border border-[var(--color-border-muted)]"
                />
                <div>
                  <h3 class="text-xl font-bold text-white">{clazz.data.name}</h3>
                </div>
              </div>
              
              {/* Description */}
              <p class="text-[var(--color-text-muted)] mb-4 flex-grow">{clazz.data.description || 'Aucune description disponible'}</p>
              
              {/* Étiquettes */}
              <div class="flex flex-col items-center gap-4 mb-6">
                <div class="flex gap-4 justify-center">
                  {clazz.data.abilities ? (
                    // Utiliser les aptitudes spécifiques définies dans le frontmatter de la classe
                    <>
                      {clazz.data.abilities.map(ability => (
                        <div class={`ability-icon-wrapper ${getAbilityBgColor(ability.type)} tooltip-container`}>
                          <Image 
                            src={ability.image.src} 
                            alt={ability.image.alt} 
                            width={30}
                            height={30}
                            class="ability-icon"
                            loading="lazy"
                            format="webp"
                          />
                          <span class="tooltip modal-tooltip">{ability.name}</span>
                        </div>
                      ))}
                    </>
                  ) : (
                    // Utiliser les aptitudes par défaut
                    <>
                      <div class="ability-icon-wrapper bg-orange-500/20 tooltip-container">
                        <Image 
                          src={dpsIcon} 
                          alt="DPS" 
                          width={30}
                          height={30}
                          class="ability-icon"
                          loading="lazy"
                          format="webp"
                        />
                        <span class="tooltip modal-tooltip">DPS</span>
                      </div>
                      <div class="ability-icon-wrapper bg-blue-500/20 tooltip-container">
                        <Image 
                          src={tankIcon} 
                          alt="Tank" 
                          width={30}
                          height={30}
                          class="ability-icon"
                          loading="lazy"
                          format="webp"
                        />
                        <span class="tooltip modal-tooltip">Tank</span>
                      </div>
                      <div class="ability-icon-wrapper bg-green-500/20 tooltip-container">
                        <Image 
                          src={controleIcon} 
                          alt="Contrôle" 
                          width={30}
                          height={30}
                          class="ability-icon"
                          loading="lazy"
                          format="webp"
                        />
                        <span class="tooltip modal-tooltip">Contrôle</span>
                      </div>
                    </>
                  )}
                </div>
                <div class="text-xs text-primary">{clazz.data.specialty}</div>
              </div>

              {/* Bouton voir plus - maintenant dans un conteneur mt-auto pour le placer en bas */}
              <div class="mt-auto flex justify-center">
                <button
                  class="btn btn-primary text-sm py-1.5 px-3 flex items-center gap-1 group"
                  data-modal-target={`modal-${clazz.data.id}`}
                >
                  En savoir plus
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transform group-hover:translate-x-1 transition-transform" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        );
      })}
    </div>
  </div>

  {/* Modales pour chaque classe */}
  {classes.map(clazz => {
    const roleStyle = roleColors[clazz.data.role] || 'text-gray-300 bg-gray-700/50 border-gray-500/50';
    
    return (
      <Modal
        id={`modal-${clazz.data.id}`}
        title={clazz.data.name}
        size="lg"
      >

        {/* Structure verticale avec défilement */}
        <div class="overflow-y-auto max-h-[75vh] pr-2 space-y-6">
          {/* Informations générales */}
          <div class="space-y-6">

            {/* Gameplay de base */}
            <div class="space-y-4">
              <div class="glass p-3 rounded-xl hover:shadow-primary/20 hover:border-[var(--color-border-highlight)] transition-all duration-300">
                <h4 class="text-base font-semibold text-cyan-400 mb-3 flex items-center gap-1">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4">
                    <path d="M10 3.75a2 2 0 10-4 0 2 2 0 004 0zM17.25 4.5a.75.75 0 000-1.5h-5.5a.75.75 0 000 1.5h5.5zM5 3.75a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5a.75.75 0 01.75.75zM4.25 17a.75.75 0 000-1.5h-1.5a.75.75 0 000 1.5h1.5zM17.25 17a.75.75 0 000-1.5h-5.5a.75.75 0 000 1.5h5.5zM9 10a.75.75 0 01-.75.75h-5.5a.75.75 0 010-1.5h5.5A.75.75 0 019 10zM17.25 10.75a.75.75 0 000-1.5h-1.5a.75.75 0 000 1.5h1.5zM14 10a2 2 0 10-4 0 2 2 0 004 0zM10 16.25a2 2 0 10-4 0 2 2 0 004 0z" />
                  </svg>
                  Gameplay de base
                </h4>
                

                
                {/* Résumé du gameplay de base par classe */}
                <div class="text-sm text-[var(--color-text-muted)] mb-4">
                  {clazz.slug === 'cra' && (
                    <>
                      <p>Les Crâs sont des archers redoutables qui excellent dans les attaques à distance. Ils peuvent infliger de lourds dégâts de zone ou sur une cible unique, tout en gardant une bonne mobilité. Leurs balises permettent de contrôler le champ de bataille en réduisant la mobilité des adversaires.</p>
                      
                      <div class="mt-2 p-2 border border-amber-500/30 rounded-lg bg-amber-950/20">
                        <h5 class="text-xs font-semibold text-amber-400 mb-1">Passif unique: Furie du Cra</h5>
                        <p class="text-xs text-[var(--color-text-muted)]">Chaque coup critique augmente vos dégâts de 5% pour 2 tours. Cumulable jusqu'à 3 fois.</p>
                      </div>
                    </>
                  )}
                  
                  {clazz.slug === 'iop' && (
                    <p>Les Iops sont des combattants puissants spécialisés dans les dégâts de mêlée. Leur force réside dans leur capacité à infliger des dégâts massifs aux ennemis proches. Ils compensent leur manque de portée par une grande mobilité et des sorts de saut.</p>
                  )}
                  
                  {clazz.slug === 'eniripsa' && (
                    <p>Les Eniripsas sont les soigneurs principaux de Wakfu. Ils peuvent se spécialiser dans les soins, les buffs d'équipe ou les attaques magiques. Leur polyvalence leur permet de s'adapter à diverses situations de combat, mais ils brillent particulièrement en groupe.</p>
                  )}
                  
                  {clazz.slug === 'sacrieur' && (
                    <p>Les Sacrieurs sont des tanks agressifs qui utilisent leurs propres points de vie comme ressource. Ils peuvent absorber d'énormes quantités de dégâts et les convertir en puissance offensive, ce qui en fait d'excellents combattants de première ligne.</p>
                  )}
                  
                  {clazz.slug === 'osamodas' && (
                    <p>Les Osamodas sont des invocateurs qui combattent aux côtés de créatures qu'ils contrôlent. Leur force réside dans la diversité de leurs invocations et leur capacité à contrôler plusieurs unités simultanément, offrant une grande flexibilité tactique.</p>
                  )}
                  
                  {clazz.slug === 'feca' && (
                    <p>Les Fécas sont spécialisés dans la protection et les armures. Ils peuvent créer des glyphes sur le terrain et offrir divers boucliers à leurs alliés, faisant d'eux d'excellents protecteurs d'équipe et contrôleurs de zone.</p>
                  )}
                  
                  {clazz.slug === 'xelor' && (
                    <p>Les Xelors manipulent le temps et l'espace. Ils peuvent ralentir leurs ennemis, se téléporter sur le champ de bataille, et infligent des dégâts qui augmentent avec le temps. Leur gameplay complexe offre de nombreuses possibilités tactiques.</p>
                  )}
                  
                  {clazz.slug === 'ecaflip' && (
                    <p>Les Ecaflips sont des joueurs qui misent sur la chance. Leurs sorts peuvent avoir des effets aléatoires extrêmement puissants. Ils peuvent jouer à distance ou en mêlée, et excellent dans les situations où la chance peut inverser le cours du combat.</p>
                  )}
                  
                  {clazz.slug === 'pandawa' && (
                    <p>Les Pandawas sont polyvalents, capables de soulever et lancer des alliés ou des ennemis. Ils peuvent également consommer de l'alcool pour renforcer leurs capacités, passant de la mêlée aux attaques à distance selon les besoins.</p>
                  )}
                  
                  {clazz.slug === 'sram' && (
                    <p>Les Srams sont des assassins furtifs utilisant pièges et poisons. Ils peuvent devenir invisibles pour se repositionner et infliger d'importants dégâts critiques. Cette classe excelle dans la surprise et l'élimination rapide de cibles isolées.</p>
                  )}
                  
                  {clazz.slug === 'sadida' && (
                    <p>Les Sadidas utilisent des poupées et contrôlent la nature. Ils peuvent planter des ronces, invoquer des poupées et manipuler le terrain. Cette classe excelle dans le contrôle de zone et l'usure avec ses dégâts sur la durée.</p>
                  )}
                  
                  {clazz.slug === 'enutrof' && (
                    <p>Les Enutrofs sont experts en fouille et collection de butins. Ils manipulent la terre et peuvent immobiliser leurs ennemis tout en générant des ressources supplémentaires. Leur style de jeu mêle contrôle et support.</p>
                  )}
                  
                  {clazz.slug === 'zobal' && (
                    <p>Les Zobals sont des maîtres du déguisement qui changent de masques pour alterner entre différents rôles. Chaque masque offre des aptitudes uniques, leur permettant de s'adapter rapidement à diverses situations de combat.</p>
                  )}
                  
                  {!['cra', 'iop', 'eniripsa', 'sacrieur', 'osamodas', 'feca', 'xelor', 'ecaflip', 'pandawa', 'sram', 'sadida', 'enutrof', 'zobal'].includes(clazz.slug) && (
                    <p>{clazz.data.description || clazz.data.specialty}</p>
                  )}
                </div>
                

              </div>
              
              {/* Mécaniques clés */}
              <div class="glass p-3 rounded-xl hover:shadow-primary/20 hover:border-[var(--color-border-highlight)] transition-all duration-300">
                <h4 class="text-base font-semibold text-emerald-400 mb-3 flex items-center gap-1">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4">
                    <path d="M10.75 16.82A7.462 7.462 0 0115 15.5c.71 0 1.396.098 2.046.282A.75.75 0 0018 15.06v-11a.75.75 0 00-.546-.721A9.006 9.006 0 0015 3a8.963 8.963 0 00-4.25 1.065V16.82zM9.25 4.065A8.963 8.963 0 005 3c-.85 0-1.673.118-2.454.339A.75.75 0 002 4.06v11c0 .332.217.626.536.72A8.961 8.961 0 005 16.5c1.756 0 3.356-.565 4.25-1.48V4.065z" />
                  </svg>
                  Mécaniques clés
                </h4>
                
                {clazz.data.abilities ? (
                  <div class="space-y-3">
                    {clazz.data.abilities.map(ability => (
                      <div class="flex gap-2">
                        <div class={`ability-icon-wrapper ${getAbilityBgColor(ability.type)} tooltip-container flex-shrink-0`}>
                          <Image 
                            src={ability.image.src} 
                            alt={ability.image.alt}
                            width={30}
                            height={30}
                            class="ability-icon"
                            loading="lazy"
                            format="webp"
                          />
                        </div>
                        <div class="text-xs text-[var(--color-text-muted)]">
                          {ability.name}
                        </div>
                      </div>
                    ))}
                  </div>
                ) : (
                  <p class="text-sm text-[var(--color-text-muted)]">
                    {clazz.slug === 'cra' ? 
                      "Les Crâs excellent dans le positionnement stratégique et le contrôle de zone. Utilisez leurs sorts à distance et balises pour contrôler le champ de bataille." :
                      "Cette classe possède des mécaniques uniques qui lui permettent de se démarquer au combat. Explorez ses compétences pour maîtriser son gameplay."}
                  </p>
                )}
              </div>
              
              {/* Progression par niveau */}
              <div class="glass p-3 rounded-xl hover:shadow-primary/20 hover:border-[var(--color-border-highlight)] transition-all duration-300">
                <h4 class="text-base font-semibold text-primary mb-3 flex items-center gap-1">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5.59L7.3 9.24a.75.75 0 00-1.1 1.02l3.25 3.5a.75.75 0 001.1 0l3.25-3.5a.75.75 0 10-1.1-1.02l-1.95 2.1V5z" clip-rule="evenodd" />
                  </svg>
                  Progression par niveau
                </h4>
                
                <div class="mb-4">
                  <div class="flex justify-between mb-2">
                    <span class="text-sm font-semibold text-amber-400">Niveau 20</span>
                    <span class="text-xs text-[var(--color-text-muted)]">Débutant</span>
                  </div>
                  
                  <div class="glass bg-black/20 p-2 rounded-lg mb-1">
                    {clazz.slug === 'cra' && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Concentrez-vous sur les sorts <span class="text-white">Distance</span> et <span class="text-white">Dégâts critiques</span></p>
                        <p class="text-xs">3 à l'arc élémentaire, 3 en flèche empoisonnée, 3 en flèche précise</p>
                      </>
                    )}
                    
                    {clazz.slug === 'iop' && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Concentrez-vous sur les sorts <span class="text-white">Tête Brûlée</span> et <span class="text-white">Concentration</span></p>
                        <p class="text-xs">3 en bond, 3 en colère de iop, 3 en charge</p>
                      </>
                    )}
                    
                    {clazz.slug === 'eniripsa' && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Balance entre <span class="text-white">Soins</span> et <span class="text-white">Dégâts</span></p>
                        <p class="text-xs">3 en mot interdit, 3 en mot stimulant, 3 en mot revitalisant</p>
                      </>
                    )}
                    
                    {!['cra', 'iop', 'eniripsa'].includes(clazz.slug) && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Débloquez vos sorts de base</p>
                        <p class="text-xs">3 points dans chacun de vos 3 sorts principaux pour débuter</p>
                      </>
                    )}
                  </div>
                  
                  <div class="text-xs text-primary mb-4 flex justify-end">
                    <a href="https://www.zenithwakfu.com/builds/wakfu/debutant" target="_blank" rel="noopener" class="inline-flex items-center gap-1 hover:underline">
                      <span>Plus de détails</span>
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25" />
                      </svg>
                    </a>
                  </div>
                </div>
                
                <div class="mb-4">
                  <div class="flex justify-between mb-2">
                    <span class="text-sm font-semibold text-orange-400">Niveau 50</span>
                    <span class="text-xs text-[var(--color-text-muted)]">Intermédiaire</span>
                  </div>
                  
                  <div class="glass bg-black/20 p-2 rounded-lg mb-1">
                    {clazz.slug === 'cra' && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Développez vos <span class="text-white">Balises</span> et <span class="text-white">Contrôle</span></p>
                        <p class="text-xs">Ajoutez 3 en balise de recall, 3 en flèche explosive, 3 points dans vos passifs</p>
                      </>
                    )}
                    
                    {clazz.slug === 'iop' && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Renforcez vos <span class="text-white">Attaques de zone</span> et <span class="text-white">Sauts</span></p>
                        <p class="text-xs">3 en intimidation, 3 en coup de pression, 3 en Uppercut</p>
                      </>
                    )}
                    
                    {clazz.slug === 'eniripsa' && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Améliorez vos <span class="text-white">Buffs d'équipe</span></p>
                        <p class="text-xs">3 en mot de jouvence, 3 en mot d'amitié, 3 en mot d'énergie</p>
                      </>
                    )}
                    
                    {!['cra', 'iop', 'eniripsa'].includes(clazz.slug) && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Développez votre spécialisation</p>
                        <p class="text-xs">Augmentez 3 sorts complémentaires et commencez à investir dans vos sorts passifs</p>
                      </>
                    )}
                  </div>
                </div>
                
                <div class="mb-1">
                  <div class="flex justify-between mb-2">
                    <span class="text-sm font-semibold text-red-400">Niveau 80</span>
                    <span class="text-xs text-[var(--color-text-muted)]">Avancé</span>
                  </div>
                  
                  <div class="glass bg-black/20 p-2 rounded-lg mb-1">
                    {clazz.slug === 'cra' && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Finalisez votre <span class="text-white">Spécialisation</span></p>
                        <p class="text-xs">Maxez vos passifs uniques, 3 en flèche brûlante, 3 en flèche d'immobilisation</p>
                      </>
                    )}
                    
                    {clazz.slug === 'iop' && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Affinez vos <span class="text-white">Compétences offensives</span></p>
                        <p class="text-xs">Maxez virulence et puissance, 3 en défi, 3 en dévouement</p>
                      </>
                    )}
                    
                    {clazz.slug === 'eniripsa' && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Maîtrisez la <span class="text-white">Gestion de ressources</span></p>
                        <p class="text-xs">3 en ralentissement, maxez vos sorts de soins principaux et vos passifs</p>
                      </>
                    )}
                    
                    {!['cra', 'iop', 'eniripsa'].includes(clazz.slug) && (
                      <>
                        <p class="text-xs text-[var(--color-text-muted)] mb-1">Perfectionnez votre personnage</p>
                        <p class="text-xs">Finalisez vos sorts principaux et maximisez vos passifs clés</p>
                      </>
                    )}
                  </div>
                </div>
                
                <p class="text-xs text-center text-[var(--color-text-muted)] mt-3 italic">
                  Après le niveau 80, vous aurez suffisamment d'expérience pour développer votre propre style de jeu.
                </p>
              </div>
            </div>
            


            {/* Builds recommandés */}
            {clazz.data.builds && clazz.data.builds.length > 0 && (
              <div>
                <h3 class="text-xl font-semibold mb-2 text-primary">Builds</h3>
                <div class="space-y-3">
                {clazz.data.builds?.map(build => (
                  <div class="glass p-3 rounded-xl hover:shadow-primary/20 hover:border-[var(--color-border-highlight)] transition-all duration-300">
                    <div>
                      <div class="flex items-center justify-between mb-1">
                        <div class="flex items-center gap-2">
                          <h5 class="font-semibold text-white text-sm">{build.name}</h5>
                          {build.playstyle && (
                            <span class={`text-xs px-1.5 py-0.5 rounded-full ${
                              build.playstyle === 'Agressif' ? 'bg-red-900/50 text-red-300 border border-red-500/50' :
                              build.playstyle === 'Défensif' ? 'bg-blue-900/50 text-blue-300 border border-blue-500/50' :
                              'bg-purple-900/50 text-purple-300 border border-purple-500/50'
                            }`}>
                              {build.playstyle}
                            </span>
                          )}
                        </div>
                        <span class="text-xs text-primary">Niv. {build.minLevel}+</span>
                      </div>
                      <div class="text-xs px-1.5 py-0.5 rounded-full bg-primary/10 text-primary inline-block mb-1">{build.type}</div>
                      <p class="text-xs text-[var(--color-text-muted)]">{build.description}</p>
                    </div>
                  </div>
                ))}
              </div>
            </div>
            )}
          </div>
          

        </div>
      </Modal>
    );
  })}
</MainLayout>

<style>
  .animate-fade-up {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeUp 0.5s ease-out forwards;
  }

  @keyframes fadeUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .ability-icon-wrapper {
    width: 2.75rem;
    height: 2.75rem;
    border-radius: 50%;
    padding: 0.25rem;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease-in-out;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .ability-icon-wrapper:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
  }

  .ability-icon {
    width: 100%;
    height: 100%;
    object-fit: contain;
    filter: 
      drop-shadow(0 0 1px black) 
      drop-shadow(0 0 1px black) 
      drop-shadow(0 0 2px rgba(0, 0, 0, 0.8)) 
      contrast(1.6) 
      brightness(0.85) 
      saturate(1.2);
  }
  
  /* Style pour le tooltip */
  .tooltip-container {
    position: relative;
  }
  
  .tooltip {
    visibility: hidden;
    position: absolute;
    top: -120px; /* Beaucoup plus haut */
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 30, 0.92); /* Fond très foncé et presque opaque */
    backdrop-filter: blur(10px);
    color: white;
    padding: 12px 16px;
    border-radius: 12px;
    font-size: 0.9rem;
    max-width: 350px; /* Beaucoup plus large */
    min-width: 250px; /* Largeur minimale */
    overflow: visible; /* Permettre de déborder */
    white-space: normal;
    text-align: left; /* Alignement à gauche pour lisibilité */
    z-index: 1000;
    opacity: 0;
    transition: all 0.3s ease;
    border: 1px solid rgba(100, 100, 255, 0.3); /* Bordure bleutée */
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.7), 0 0 15px rgba(0, 100, 255, 0.2);
    line-height: 1.5;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
    pointer-events: none; /* Pour éviter les problèmes d'interaction */
    height: auto; /* Hauteur automatique */
  }
  
  .tooltip::after {
    content: "";
    position: absolute;
    bottom: -12px; /* Flèche plus grande */
    left: 50%;
    transform: translateX(-50%);
    border-width: 12px 12px 0; /* Triangle plus grand */
    border-style: solid;
    border-color: rgba(0, 0, 30, 0.92) transparent transparent;
    filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.3));
  }
  
  .tooltip-container:hover .tooltip {
    visibility: visible;
    opacity: 1;
    top: -130px; /* Position finale plus élevée */
  }
  
  /* Désactiver les tooltips dans la modale */
  .modal-icon:hover .modal-tooltip {
    visibility: hidden;
    opacity: 0;
  }
</style>

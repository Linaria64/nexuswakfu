---
// Supposons que vous ayez un Layout de base.
// Si ce n'est pas le cas, vous pouvez supprimer cette ligne et la balise <Layout>.
import Layout from "../layouts/layout.astro";

// Définissez ici la structure de vos paliers et missions.
// Vous devrez remplir cela avec vos propres données.
const tiersData = [
  {
    id: "palier1",
    nom: "Palier 1-10",
    descriptionNiveau: "Niveaux 1 à 10",
    seuilXPNextPalier: 100, // Pourcentage pour passer au palier suivant
    missions: [
      {
      id: "m1-1",
      titre: "Tutoriel sur l'île de Ri",
      image: "https://via.placeholder.com/150/FF6B35/FFFFFF?Text=IleRi",
      resumeCourt: "Complétez le tutoriel complet sur l'île de Ri.",
      resumeComplet:
        "Votre aventure commence sur l'île mystérieuse de Ri ! Cette mission obligatoire vous fera découvrir tous les mécanismes de base de NexusWakfu. Apprenez à vous déplacer, à attaquer, à utiliser vos sorts et à interagir avec l'environnement. Suivez attentivement les instructions du guide tutoriel, explorez chaque zone de l'île et accomplissez toutes les tâches demandées. Vous découvrirez comment récolter des ressources, combattre vos premiers monstres et comprendre l'interface de jeu. À la fin de ce tutoriel complet, vous atteindrez le niveau 6 et serez prêt à rejoindre le continent principal. Cette étape est essentielle pour maîtriser les bases avant de vous aventurer dans le vaste monde de NexusWakfu.",
      xp: 50,
      },
      {
      id: "m1-2",
      titre: "Quête de Pépé Pale jusqu'au Prologue",
      image: "https://via.placeholder.com/150/4ECDC4/FFFFFF?Text=PepePale",
      resumeCourt: "Suivez Pépé Pale à Astrub jusqu'au Prologue.",
      resumeComplet:
        "Une fois arrivé à Astrub depuis l'île de Ri, votre première priorité est de retrouver le mystérieux Pépé Pale. Ce personnage emblématique vous guidera à travers une série de quêtes captivantes qui vous feront découvrir la ville d'Astrub et ses environs. Explorez les différents quartiers, rencontrez les habitants locaux et accomplissez les tâches que Pépé Pale vous confie. Cette chaîne de quêtes vous mènera progressivement vers le Prologue, une étape cruciale de votre parcours. Vous apprendrez les spécificités de votre classe, découvrirez l'histoire du monde et développerez vos premières stratégies de combat. En complétant cette série de quêtes obligatoires, vous atteindrez le niveau 10 et serez officiellement initié aux mystères de NexusWakfu.",
      xp: 50,
      },
    ],
  },
  {
    id: "palier2", // ID corrigé pour être unique
    nom: "Palier 11-20", // Nom ajusté pour refléter un nouveau palier
    descriptionNiveau: "Niveaux 11 à 20",
    seuilXPNextPalier: 90,
    missions: [
      {
        id: "m2-1",
        titre: "Découverte des quêtes environnementales d'Astrub",
        image: "https://via.placeholder.com/150/32CD32/FFFFFF?Text=QuestesEnviro",
        resumeCourt: "Explorez les quêtes environnementales pour obtenir des Sioupières Glou.",
        resumeComplet:
          "Partez à la découverte des différentes zones environnementales d'Astrub ! Ces quêtes spéciales vous permettront de récolter des Sioupières Glou, des objets de valeur très recherchés par les joueurs expérimentés. Explorez les plaines, les forêts et les zones marécageuses autour d'Astrub. Chaque environnement propose des défis uniques et des récompenses spécifiques. Les Sioupières Glou que vous obtiendrez peuvent être vendues à bon prix sur le marché, vous permettant de financer vos futurs équipements. Cette activité vous familiarisera également avec l'écosystème complexe de NexusWakfu et l'importance de la préservation environnementale dans le jeu.",
        xp: 40,
      },
      {
        id: "m2-2",
        titre: "Découverte des métiers de récolte",
        image: "https://via.placeholder.com/150/8B4513/FFFFFF?Text=Recolte",
        resumeCourt: "Initiez-vous aux métiers de récolte pour devenir autonome.",
        resumeComplet:
          "Il est temps d'apprendre les métiers de base qui vous rendront autonome dans NexusWakfu ! Dirigez-vous vers les différentes zones de récolte autour d'Astrub et initiez-vous aux métiers fondamentaux : Bûcheron pour couper du bois, Mineur pour extraire des minerais, Paysan pour cultiver des céréales, et Pêcheur pour attraper des poissons. Chaque métier a ses propres outils et techniques. Commencez par récolter des ressources de niveau 1 à 20 pour vous familiariser avec les mécaniques. Ces ressources vous serviront plus tard pour l'artisanat et vous permettront de générer des revenus réguliers. Prenez le temps de comprendre les cycles de repousse des ressources et les meilleures zones de récolte.",
        xp: 20,
      },
      {
        id: "m2-3",
        titre: "Chasse aux groupes de Bouftout",
        image: "https://via.placeholder.com/150/FF6347/FFFFFF?Text=Bouftout",
        resumeCourt: "Chassez des petits groupes de Bouftout pour vous équiper.",
        resumeComplet:
          "Les Bouftout sont d'excellentes créatures pour s'entraîner au combat en groupe et obtenir des équipements de qualité ! Formez des groupes de 2 à 4 joueurs et partez chasser ces créatures dans les plaines d'Astrub. Les Bouftout se déplacent souvent en petits troupeaux, ce qui vous permettra de vous exercer aux tactiques de groupe et à la coordination. Leurs drops incluent de la laine précieuse, de la viande nutritive et parfois des équipements utiles pour votre niveau. Variez vos cibles entre Bouftout Blanc, Bouftout Noir et Bouftout Sauvage pour découvrir leurs différentes récompenses. Cette chasse vous préparera aux défis plus importants qui vous attendent.",
        xp: 30,
      },
      {
        id: "m2-4",
        titre: "Donjon du Bouftout Royal en Stasis 1",
        image: "https://via.placeholder.com/150/DAA520/FFFFFF?Text=BouftoutRoyal",
        resumeCourt: "Affrontez le Bouftout Royal dans son donjon en difficulté Stasis 1.",
        resumeComplet:
          "Le moment est venu d'affronter votre premier véritable défi : le Donjon du Bouftout Royal en Stasis 1 ! Ce donjon emblématique d'Astrub vous confrontera au majestueux Bouftout Royal et à sa garde rapprochée. Formez une équipe équilibrée de 3 à 6 joueurs avec différentes classes pour maximiser vos chances de succès. Le Bouftout Royal possède des attaques puissantes et des sorts de zone, vous devrez donc coordonner vos actions et utiliser des stratégies de positionnement. La difficulté Stasis 1 est parfaite pour votre niveau et vous récompensera avec des équipements de qualité supérieure, des kamas et de l'expérience précieuse. N'oubliez pas d'apporter des potions de soin et de préparer vos sorts avant le combat !",
        xp: 10,
      },
    ],
  },
  // Ajoutez d'autres paliers jusqu'au niveau 50.
  {
    id: "palier3", // Ajout d'un palier intermédiaire pour tester la progression
    nom: "Palier 21-30",
    descriptionNiveau: "Niveaux 21 à 30",
    seuilXPNextPalier: 80,
    missions: [
      {
      id: "m3-1",
      titre: "Quêtes de Nation - Chapitre 1",
      image: "https://via.placeholder.com/150/9932CC/FFFFFF?Text=Nation1",
      resumeCourt: "Commencez votre parcours citoyen en rejoignant une nation.",
      resumeComplet:
        "Il est temps de choisir votre camp et de devenir citoyen d'une des grandes nations de NexusWakfu ! Rendez-vous dans les capitales (Bonta, Brâkmar ou Sufokia) et entamez les quêtes de citoyenneté. Ces missions vous feront découvrir l'histoire, les valeurs et les traditions de votre nation choisie. Vous devrez prouver votre loyauté en accomplissant diverses tâches : aider les citoyens locaux, défendre les intérêts de votre nation et participer aux activités communautaires. Le Chapitre 1 vous initiera aux mécaniques politiques et vous donnera accès aux premiers avantages citoyens, notamment l'accès aux zones réservées et aux quêtes spéciales de votre nation.",
      xp: 40,
      },
      {
      id: "m3-2",
      titre: "Quêtes de Nation - Chapitre 2",
      image: "https://via.placeholder.com/150/DC143C/FFFFFF?Text=Nation2",
      resumeCourt: "Approfondissez votre engagement citoyen et grimpez en grade.",
      resumeComplet:
        "Poursuivez votre ascension dans la hiérarchie de votre nation en complétant le Chapitre 2 des quêtes nationales ! Ces missions plus complexes vous demanderont de participer activement à la vie politique et militaire de votre nation. Vous devrez peut-être mener des missions d'espionnage, participer à des batailles contre les nations rivales, ou négocier des alliances diplomatiques. Ce chapitre vous révélera des secrets d'État et vous donnera accès à des équipements et sorts exclusifs à votre nation. Votre grade citoyen augmentera, vous offrant plus de privilèges et de responsabilités au sein de votre communauté nationale.",
      xp: 40,
      },
      {
      id: "m3-3",
      titre: "Découverte d'Amakna",
      image: "https://via.placeholder.com/150/228B22/FFFFFF?Text=Amakna",
      resumeCourt: "Explorez le continent sauvage d'Amakna et ses mystères.",
      resumeComplet:
        "Partez à la découverte d'Amakna, le continent principal de NexusWakfu ! Cette vaste terre regorge de biomes variés, de créatures fascinantes et de trésors cachés. Explorez les forêts enchantées, les plaines verdoyantes, les marécages mystérieux et les montagnes escarpées. Chaque région d'Amakna a ses propres spécificités : ressources uniques, monstres particuliers et quêtes locales. Découvrez les villages pittoresques comme Kelba, les donjons légendaires et les zones de ressources de haut niveau. Cette exploration vous permettra de cartographier le continent, de débloquer de nouveaux zaaps (points de téléportation) et de vous familiariser avec la géographie complexe qui sera cruciale pour vos futures aventures.",
      xp: 20,
      },
    ],
  },
  {
    id: "palier4", // Ajout d'un palier intermédiaire pour tester la progression
    nom: "Palier 31-40",
    descriptionNiveau: "Niveaux 31 à 40",
    seuilXPNextPalier: 90,
    missions: [
      {
      id: "m4-1",
      titre: "Quêtes de Nation - Chapitre 3 Bonta",
      image: "https://via.placeholder.com/150/4169E1/FFFFFF?Text=BontaCh3",
      resumeCourt: "Poursuivez votre parcours citoyen à Bonta avec le Chapitre 3.",
      resumeComplet:
        "Continuez votre ascension dans la hiérarchie de Bonta en complétant le Chapitre 3 des quêtes nationales. Ces missions avancées vous plongeront au cœur des intrigues politiques de la cité blanche. Vous devrez peut-être infiltrer des réseaux d'espions, protéger des dignitaires ou mener des opérations diplomatiques délicates. Ce chapitre révèle les secrets les mieux gardés de Bonta et vous prépare aux responsabilités de haut rang. Votre loyauté sera mise à l'épreuve et vos décisions auront un impact sur l'avenir de la nation. En récompense, vous débloquerez des équipements exclusifs et des sorts puissants réservés aux citoyens d'élite de Bonta.",
      xp: 30,
      },
      {
      id: "m4-2",
      titre: "Quêtes de Nation - Chapitre 4 Brâkmar",
      image: "https://via.placeholder.com/150/8B0000/FFFFFF?Text=BrakmarCh4",
      resumeCourt: "Explorez les mystères sombres de Brâkmar au Chapitre 4.",
      resumeComplet:
        "Plongez dans les profondeurs de Brâkmar et découvrez les secrets les plus sombres de cette nation mystérieuse. Le Chapitre 4 vous confrontera aux aspects les plus dangereux de la politique brâkmarienne : complots d'assassinat, magie interdite et alliances occultes. Vous devrez naviguer dans un monde d'ombres et de trahisons où chaque décision peut être fatale. Ces missions vous donneront accès aux techniques de combat les plus redoutables et aux sorts les plus puissants de Brâkmar. Votre rang dans la hiérarchie brâkmarienne atteindra des sommets, vous octroyant des privilèges exceptionnels et l'accès aux zones les plus secrètes de la cité noire.",
      xp: 30,
      },
      {
      id: "m4-3",
      titre: "Optimisation d'équipement : Moogr et Craqueleur",
      image: "https://via.placeholder.com/150/FF8C00/FFFFFF?Text=Equipment",
      resumeCourt: "Équipez-vous selon votre style de combat : Moogr pour la distance, Craqueleur pour le mélée.",
      resumeComplet:
        "Il est temps d'optimiser votre équipement selon votre style de jeu ! Pour les combattants à distance, concentrez-vous sur l'ensemble Moogr qui offre d'excellents bonus de portée et de dommages à distance. Recherchez les bottes, la coiffe et la cape Moogr qui améliorent significativement vos capacités de frappe à longue portée. Pour les guerriers de mélée, l'équipement Craqueleur est idéal avec ses bonus de résistance et de dommages au corps à corps. Farmez les différentes pièces de ces sets en chassant les monstres appropriés ou en les achetant à l'hôtel de vente. Un bon équipement adapté à votre classe fera toute la différence dans les combats à venir !",
      xp: 10,
      },
      {
      id: "m4-4",
      titre: "Donjon de la Mort Brûlée en Stasis 3",
      image: "https://via.placeholder.com/150/DC143C/FFFFFF?Text=MortBrulee",
      resumeCourt: "Affrontez le donjon de la Mort Brûlée en groupe pour farmer les Bottes de Koko et espérer le drop de Kyou Aile.",
      resumeComplet:
        "Préparez-vous pour l'un des défis les plus intenses de votre parcours : le Donjon de la Mort Brûlée en difficulté Stasis 3 ! Ce donjon redoutable demande une équipe expérimentée de 4 à 6 joueurs parfaitement coordonnés. Votre objectif principal est de farmer les précieuses Bottes de Koko, un équipement très recherché pour leurs excellentes statistiques. Mais le véritable trésor serait de voir apparaître la légendaire Kyou Aile, un drop extrêmement rare qui fera de vous l'envie de tous les joueurs. La difficulté Stasis 3 augmente considérablement les statistiques des monstres, mais aussi les chances de drops rares. Préparez vos meilleures stratégies, vos potions les plus puissantes et armez-vous de patience pour ce farm intensif !",
      xp: 30,
      },
    ],
  },
  {
    id: "palierFinal",
    nom: "Palier 41-50",
    descriptionNiveau: "Niveaux 41 à 50",
    seuilXPNextPalier: 100,
    missions: [
      {
      id: "mf-1",
      titre: "Quêtes de Nation - Chapitre Final Sufokia",
      image: "https://via.placeholder.com/150/FF8C00/FFFFFF?Text=SufokiaFinal",
      resumeCourt: "Complétez le dernier chapitre des quêtes nationales de Sufokia.",
      resumeComplet:
        "Terminez votre parcours citoyen de Sufokia avec le chapitre final de cette nation maritime. Plongez dans les mystères des profondeurs océaniques et découvrez les secrets ancestraux des Sufokiens. Vous devrez naviguer entre les intrigues des marchands, les légendes des pirates et les mystères des créatures des abysses. Ce chapitre final vous révélera l'histoire cachée de Sufokia et vous donnera accès aux plus grands trésors de cette nation aquatique. Votre rang de citoyen atteindra son apogée, vous octroyant des privilèges uniques et l'accès aux zones les plus secrètes des cités sous-marines sufokiennes.",
      xp: 100,
      },
    ],
  },
];
---

<Layout title="Guide de Progression NexusWakfu">
  <div class="guide-nexuswakfu">
    <h1>Guide de Progression Interactif</h1>
    <div style="text-align: center; margin-bottom: 20px;">
      <a href="/" class="btn-accueil">← Retour à l'accueil</a>
    </div>
    <div id="paliers-container">
      <!-- Les paliers seront injectés ici par JavaScript -->
    </div>

    <div
      id="message-felicitations"
      class="hidden"
      style="text-align: center; margin-top: 30px; padding: 25px; background-color: #e6ffed; border: 2px solid #34d399; border-radius: 8px; color: #065f46;"
    >
      <h2>🎉 Félicitations ! 🎉</h2>
      <p>
        Vous avez brillamment complété tous les paliers du guide ! Vous êtes un
        véritable expert de NexusWakfu !
      </p>
    </div>
  </div>

  <script define:vars={{ tiersData }}>
    const paliersContainer = document.getElementById("paliers-container");
    const messageFelicitations = document.getElementById(
      "message-felicitations"
    );
    let palierActuelIndex = 0;
    let elementsPaliersDom = []; // Pour stocker les éléments DOM des paliers
    let passageEnCours = false; // Variable pour suivre si un passage est en cours
    let timerPassage = null; // Pour stocker l'ID du timer de passage

    function creerCarteMission(mission, callbackValidation) {
      const carte = document.createElement("div");
      carte.className = "mission-carte";
      carte.dataset.missionId = mission.id;

      const img = document.createElement("img");
      img.src = mission.image;
      img.alt = mission.titre;
      carte.appendChild(img);

      const titre = document.createElement("h3");
      titre.textContent = mission.titre;
      carte.appendChild(titre);

      const resumeCourtEl = document.createElement("p");
      resumeCourtEl.className = "resume-court";
      resumeCourtEl.textContent = mission.resumeCourt;
      carte.appendChild(resumeCourtEl);

      const resumeCompletEl = document.createElement("p");
      resumeCompletEl.className = "resume-complet hidden";
      // Assurez-vous que mission.resumeComplet contient suffisamment de texte.
      resumeCompletEl.textContent = mission.resumeComplet;
      carte.appendChild(resumeCompletEl);

      const btnVoirPlus = document.createElement("button");
      btnVoirPlus.className = "btn-voir-plus";
      btnVoirPlus.textContent = "Voir plus";
      btnVoirPlus.onclick = () => {
        resumeCourtEl.classList.toggle("hidden");
        resumeCompletEl.classList.toggle("hidden");
        btnVoirPlus.textContent = resumeCompletEl.classList.contains("hidden")
          ? "Voir plus"
          : "Voir moins";
      };
      carte.appendChild(btnVoirPlus);

      const btnValider = document.createElement("button");
      btnValider.className = "btn-valider";
      btnValider.textContent = "Valider";
      btnValider.onclick = () => {
        if (!carte.classList.contains("validee")) {
          carte.classList.add("validee");
          btnValider.textContent = "Validée ✔";
          btnValider.disabled = true;
          btnVoirPlus.disabled = true; // Optionnel: désactiver aussi voir plus
          callbackValidation(mission.xp);
        }
      };
      carte.appendChild(btnValider);

      return carte;
    }

    function afficherPalier(index) {
      // Vérifier si l'index est valide
      if (index < 0 || index > tiersData.length) {
        console.error("Index de palier invalide:", index);
        return;
      }

      // Réinitialiser l'état de passage
      passageEnCours = false;
      if (timerPassage) {
        clearTimeout(timerPassage);
        timerPassage = null;
      }

      // Cacher tous les paliers précédemment affichés
      elementsPaliersDom.forEach((element) => {
        if (element) {
          element.style.display = "none";
        }
      });

      // Si le palier actuel a déjà été rendu, le montrer et sortir
      if (elementsPaliersDom[index]) {
        elementsPaliersDom[index].style.display = "block";
        return;
      }

      if (index >= tiersData.length) {
        // Tous les paliers sont complétés
        messageFelicitations.classList.remove("hidden");
        return;
      }

      const palierData = tiersData[index];
      const divPalier = document.createElement("div");
      divPalier.className = "palier";
      divPalier.dataset.palierId = palierData.id;
      elementsPaliersDom[index] = divPalier;

      // Ajouter un en-tête avec le numéro du palier pour faciliter le débogage
      const debugInfo = document.createElement("div");
      debugInfo.className = "debug-info";
      debugInfo.textContent = `Palier actuel: ${index + 1} sur ${tiersData.length}`;
      debugInfo.style.fontSize = "0.8em";
      debugInfo.style.color = "#888";
      debugInfo.style.marginBottom = "5px";
      divPalier.appendChild(debugInfo);

      const titrePalier = document.createElement("h2");
      titrePalier.textContent = `${palierData.nom} (${palierData.descriptionNiveau})`;
      divPalier.appendChild(titrePalier);

      const barreProgressionContainer = document.createElement("div");
      barreProgressionContainer.className = "barre-progression-container";
      const barreProgression = document.createElement("div");
      barreProgression.className = "barre-progression";
      barreProgression.style.width = "0%";
      barreProgressionContainer.appendChild(barreProgression);
      divPalier.appendChild(barreProgressionContainer);

      const texteProgression = document.createElement("p");
      texteProgression.className = "texte-progression";
      texteProgression.textContent = "Progression: 0%";
      divPalier.appendChild(texteProgression);

      const missionsContainer = document.createElement("div");
      missionsContainer.className = "missions-grille";
      divPalier.appendChild(missionsContainer);

      let xpAccumule = 0;
      const xpTotalPalier = palierData.missions.reduce(
        (total, m) => total + m.xp,
        0
      );

      palierData.missions.forEach((mission) => {
        const carteMission = creerCarteMission(mission, (xpGagnee) => {
          xpAccumule += xpGagnee;
          const pourcentage =
            xpTotalPalier > 0
              ? Math.min(100, (xpAccumule / xpTotalPalier) * 100)
              : 0;
          barreProgression.style.width = `${pourcentage}%`;
          texteProgression.textContent = `Progression: ${Math.round(pourcentage)}%`;

          // Vérifier si la progression est suffisante pour débloquer le prochain palier
          // et s'assurer qu'un passage n'est pas déjà programmé
          if (pourcentage >= palierData.seuilXPNextPalier && !passageEnCours) {
            // Marquer qu'un passage est en cours
            passageEnCours = true;

            // Supprimer tout ancien message de déblocage
            const ancienMessage = divPalier.querySelector(".message-deblocage");
            if (ancienMessage) {
              divPalier.removeChild(ancienMessage);
            }

            // Afficher un message pour informer l'utilisateur
            const msgDeblocage = document.createElement("div");
            msgDeblocage.className = "message-deblocage";
            msgDeblocage.textContent = `Vous avez débloqué le palier suivant ! Chargement dans 3 secondes...`;
            msgDeblocage.style.color = "var(--couleur-succes)";
            msgDeblocage.style.fontWeight = "bold";
            msgDeblocage.style.marginTop = "10px";
            msgDeblocage.style.textAlign = "center";

            divPalier.appendChild(msgDeblocage);

            // Annuler tout timer précédent
            if (timerPassage) {
              clearTimeout(timerPassage);
            }

            // Créer un nouveau timer
            timerPassage = setTimeout(() => {
              // Vérifier que nous sommes toujours sur le même palier
              if (palierActuelIndex === index) {
                passerAuPalierSuivant();
              }
            }, 3000);
          }
        });
        missionsContainer.appendChild(carteMission);
      });

      paliersContainer.appendChild(divPalier);

      // Log de débogage
      console.log(
        `Palier ${index + 1}/${tiersData.length} affiché: ${palierData.nom}`
      );
    }

    function passerAuPalierSuivant() {
      // Réinitialiser les variables de contrôle
      passageEnCours = false;
      if (timerPassage) {
        clearTimeout(timerPassage);
        timerPassage = null;
      }

      // S'assurer qu'on ne dépasse pas le nombre de paliers disponibles
      if (palierActuelIndex < tiersData.length - 1) {
        console.log(
          `Passage du palier ${palierActuelIndex + 1} au palier ${palierActuelIndex + 2}`
        );
        palierActuelIndex++;
        afficherPalier(palierActuelIndex);
      } else {
        // Si c'est le dernier palier, afficher le message de félicitations
        console.log("Dernier palier complété, affichage des félicitations");
        messageFelicitations.classList.remove("hidden");
        // Cacher le dernier palier
        if (elementsPaliersDom[palierActuelIndex]) {
          elementsPaliersDom[palierActuelIndex].style.display = "none";
        }
      }
    }

    // Affichage initial du premier palier
    afficherPalier(palierActuelIndex);
  </script>

  <style is:global>
    :root {
      --couleur-principale: #4a90e2; /* Bleu Nexus */
      --couleur-succes: #50e3c2; /* Vert menthe succès */
      --couleur-texte: #333;
      --couleur-fond-carte: #ffffff;
      --couleur-fond-page: #f4f7f6;
      --ombre-carte: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background-color: var(--couleur-fond-page);
      color: var(--couleur-texte);
      line-height: 1.6;
    }

    .guide-nexuswakfu {
      max-width: 1000px;
      margin: 20px auto;
      padding: 20px;
      background-color: var(--couleur-fond-carte);
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
    }

    .guide-nexuswakfu h1 {
      text-align: center;
      color: var(--couleur-principale);
      margin-bottom: 30px;
    }

    .palier {
      margin-bottom: 40px;
      padding: 20px;
      background-color: #fff;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      box-shadow: var(--ombre-carte);
    }

    .palier h2 {
      color: var(--couleur-principale);
      border-bottom: 2px solid var(--couleur-principale);
      padding-bottom: 10px;
      margin-top: 0;
    }

    .barre-progression-container {
      width: 100%;
      background-color: #e0e0e0;
      border-radius: 25px;
      margin: 15px 0;
      height: 25px;
      overflow: hidden;
    }

    .barre-progression {
      height: 100%;
      width: 0%;
      background-color: var(--couleur-succes);
      border-radius: 25px;
      transition: width 0.6s ease-in-out;
      text-align: center;
      color: white;
      font-weight: bold;
      line-height: 25px; /* Pour centrer le texte si on en met */
    }

    .texte-progression {
      text-align: right;
      font-size: 0.9em;
      color: #555;
      margin-top: 5px;
    }

    .missions-grille {
      display: grid;
      /* Augmentation de la largeur minimale pour que les cartes prennent plus de place */
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    /* Pour les écrans larges, nous visons moins de cartes par ligne pour qu'elles soient plus larges. */
    @media (min-width: 992px) {
      /* S'aligne sur la largeur max du conteneur .guide-nexuswakfu */
      .missions-grille {
        /* Réduction du nombre de colonnes pour des cartes plus larges */
        grid-template-columns: repeat(3, 1fr);
      }
    }

    .mission-carte {
      background-color: var(--couleur-fond-carte);
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      box-shadow: var(--ombre-carte);
      transition:
        transform 0.2s ease-out,
        box-shadow 0.2s ease-out;
      display: flex;
      flex-direction: column;
    }

    .mission-carte:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
    }

    .mission-carte.validee {
      background-color: #f0fff4; /* Vert très clair */
      opacity: 0.75;
      border-left: 5px solid var(--couleur-succes);
    }

    .mission-carte.validee:hover {
      transform: none;
      box-shadow: var(--ombre-carte);
    }

    .mission-carte img {
      width: 100%;
      height: 120px; /* Ajusté légèrement pour des cartes plus petites */
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 10px;
    }

    .mission-carte h3 {
      margin-top: 0;
      margin-bottom: 8px;
      font-size: 1.1em; /* Légèrement réduit pour cartes plus petites */
      color: #333;
    }

    .mission-carte p {
      font-size: 0.9em; /* Légèrement réduit */
      margin-bottom: 12px;
      flex-grow: 1;
    }
    .mission-carte .resume-complet {
      font-size: 0.85em; /* Légèrement réduit */
      color: #555;
    }

    .mission-carte button {
      padding: 8px 12px; /* Ajusté pour des cartes plus petites */
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.2s ease;
      margin-top: 5px;
    }

    .mission-carte .btn-voir-plus {
      background-color: #e0e0e0;
      color: #333;
      margin-right: 5px; /* Ajustement pour espacement si les boutons sont sur la même ligne */
    }
    .mission-carte .btn-voir-plus:hover {
      background-color: #c7c7c7;
    }

    .mission-carte .btn-valider {
      background-color: var(--couleur-principale);
      color: white;
    }
    .mission-carte .btn-valider:hover {
      background-color: #3a7bc8;
    }
    .mission-carte .btn-valider:disabled {
      background-color: var(--couleur-succes);
      color: #065f46;
      cursor: not-allowed;
    }
    .mission-carte .btn-valider:disabled:hover {
      background-color: var(--couleur-succes);
    }

    .hidden {
      display: none !important;
    }

    /* Style pour le message de déblocage */
    .message-deblocage {
      padding: 10px;
      background-color: rgba(80, 227, 194, 0.1);
      border-radius: 5px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0% {
        opacity: 0.6;
      }
      50% {
        opacity: 1;
      }
      100% {
        opacity: 0.6;
      }
    }

    /* Style pour l'info de débogage */
    .debug-info {
      background-color: #f5f5f5;
      padding: 5px;
      border-radius: 3px;
      margin-bottom: 10px;
    }
  </style>
</Layout>

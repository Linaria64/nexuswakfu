---
// Supposons que vous ayez un Layout de base.
// Si ce n'est pas le cas, vous pouvez supprimer cette ligne et la balise <Layout>.
import Layout from "../layouts/layout.astro";

// Définissez ici la structure de vos paliers et missions.
// Vous devrez remplir cela avec vos propres données.
const tiersData = [
  {
    id: "palier1",
    nom: "Palier 1-10",
    descriptionNiveau: "Niveaux 1 à 10",
    seuilXPNextPalier: 70, // Pourcentage pour passer au palier suivant
    missions: [
      {
        id: "m1-1",
        titre: "Premiers pas",
        image: "https://via.placeholder.com/150/FF0000/FFFFFF?Text=Mission1",
        resumeCourt: "Apprenez les bases du jeu.",
        resumeComplet:
          "Ceci est le résumé complet de la mission 'Premiers pas'. Votre aventure commence ici ! Explorez la zone de départ pittoresque, découvrez ses secrets cachés et interagissez avec les habitants. Vous devrez parler à au moins trois personnages non-joueurs (PNJ) pour recueillir des informations cruciales. Prenez le temps de vous familiariser avec l'interface utilisateur : ouvrez votre inventaire, consultez la carte du monde et apprenez à utiliser vos premières compétences. N'oubliez pas de consulter le tutoriel initial accessible via le menu d'aide ; il regorge d'astuces supplémentaires pour bien démarrer votre épopée dans NexusWakfu. Accomplir cette mission vous préparera pour les défis à venir.",
        xp: 20,
      },
      {
        id: "m1-2",
        titre: "Chasse initiatique",
        image: "https://via.placeholder.com/150/00FF00/FFFFFF?Text=Mission2",
        resumeCourt: "Affrontez vos premiers monstres.",
        resumeComplet:
          "Dirigez-vous vers la forêt luxuriante au nord du village. Votre objectif est de vaincre 5 monstres de type 'Boufton Sauvage'. Faites attention à leurs attaques et utilisez vos compétences à bon escient. Ces créatures peuvent sembler inoffensives, mais en groupe, elles représentent un défi pour les nouveaux aventuriers. Pensez à utiliser des potions si nécessaire.",
        xp: 30,
      },
      {
        id: "m1-3",
        titre: "Découverte d'un métier",
        image: "https://via.placeholder.com/150/0000FF/FFFFFF?Text=Mission3",
        resumeCourt: "Essayez-vous à l'artisanat.",
        resumeComplet:
          "Trouvez l'atelier des artisans dans la ville principale. Parlez au maître artisan pour apprendre les rudiments de la récolte et de la fabrication. Essayez de fabriquer votre premier objet simple, comme une 'Potion de Soin Mineure' ou un 'Anneau Agilesque'. L'artisanat est une partie importante de l'économie du jeu et peut vous fournir des équipements puissants.",
        xp: 25,
      },
      {
        id: "m1-4",
        titre: "Exploration de crypte",
        image: "https://via.placeholder.com/150/CCCCCC/000000?Text=Mission4",
        resumeCourt: "Visitez la crypte locale.",
        resumeComplet:
          "La vieille crypte à l'est du village renferme des secrets et des trésors oubliés. Aventurez-vous à l'intérieur et trouvez un artefact ancien. Attention aux pièges dissimulés et aux créatures squelettiques qui y rodent. Une torche pourrait être utile pour éclairer les recoins sombres.",
        xp: 20,
      },
      {
        id: "m1-5",
        titre: "Quête de livraison",
        image: "https://via.placeholder.com/150/9966CC/FFFFFF?Text=Mission5",
        resumeCourt: "Aidez un marchand.",
        resumeComplet:
          "Un marchand local a besoin d'aide pour livrer un colis important à un village voisin. Le chemin peut être dangereux, parsemé de bandits ou de bêtes sauvages, alors soyez prudent et préparez-vous au combat. La récompense en vaut la peine.",
        xp: 15,
      },
      {
        id: "m1-6",
        titre: "Entraînement au combat",
        image: "https://via.placeholder.com/150/FF9900/FFFFFF?Text=Mission6",
        resumeCourt: "Améliorez vos techniques.",
        resumeComplet:
          "Rendez-vous au camp d'entraînement et parlez au maître d'armes. Complétez une série d'épreuves pour parfaire vos compétences de combat, apprendre de nouvelles techniques et comprendre les combos dévastateurs de votre classe.",
        xp: 30,
      },
    ],
  },
  {
    id: "palier2", // ID corrigé pour être unique
    nom: "Palier 11-20", // Nom ajusté pour refléter un nouveau palier
    descriptionNiveau: "Niveaux 11 à 20",
    seuilXPNextPalier: 70,
    missions: [
      {
        id: "m2-1", // ID corrigé pour éviter les doublons
        titre: "Premiers pas",
        image: "https://via.placeholder.com/150/FF0000/FFFFFF?Text=Mission1",
        resumeCourt: "Apprenez les bases du jeu.",
        resumeComplet:
          "Ceci est le résumé complet de la mission 'Premiers pas'. Votre aventure commence ici ! Explorez la zone de départ pittoresque, découvrez ses secrets cachés et interagissez avec les habitants. Vous devrez parler à au moins trois personnages non-joueurs (PNJ) pour recueillir des informations cruciales. Prenez le temps de vous familiariser avec l'interface utilisateur : ouvrez votre inventaire, consultez la carte du monde et apprenez à utiliser vos premières compétences. N'oubliez pas de consulter le tutoriel initial accessible via le menu d'aide ; il regorge d'astuces supplémentaires pour bien démarrer votre épopée dans NexusWakfu. Accomplir cette mission vous préparera pour les défis à venir.",
        xp: 20,
      },
      {
        id: "m2-2",
        titre: "Chasse initiatique",
        image: "https://via.placeholder.com/150/00FF00/FFFFFF?Text=Mission2",
        resumeCourt: "Affrontez vos premiers monstres.",
        resumeComplet:
          "Dirigez-vous vers la forêt luxuriante au nord du village. Votre objectif est de vaincre 5 monstres de type 'Boufton Sauvage'. Faites attention à leurs attaques et utilisez vos compétences à bon escient. Ces créatures peuvent sembler inoffensives, mais en groupe, elles représentent un défi pour les nouveaux aventuriers. Pensez à utiliser des potions si nécessaire.",
        xp: 30,
      },
      {
        id: "m2-3",
        titre: "Découverte d'un métier",
        image: "https://via.placeholder.com/150/0000FF/FFFFFF?Text=Mission3",
        resumeCourt: "Essayez-vous à l'artisanat.",
        resumeComplet:
          "Trouvez l'atelier des artisans dans la ville principale. Parlez au maître artisan pour apprendre les rudiments de la récolte et de la fabrication. Essayez de fabriquer votre premier objet simple, comme une 'Potion de Soin Mineure' ou un 'Anneau Agilesque'. L'artisanat est une partie importante de l'économie du jeu et peut vous fournir des équipements puissants.",
        xp: 25,
      },
      {
        id: "m2-4",
        titre: "Exploration de crypte",
        image: "https://via.placeholder.com/150/CCCCCC/000000?Text=Mission4",
        resumeCourt: "Visitez la crypte locale.",
        resumeComplet:
          "La vieille crypte à l'est du village renferme des secrets et des trésors oubliés. Aventurez-vous à l'intérieur et trouvez un artefact ancien. Attention aux pièges dissimulés et aux créatures squelettiques qui y rodent. Une torche pourrait être utile pour éclairer les recoins sombres.",
        xp: 20,
      },
      {
        id: "m2-5",
        titre: "Quête de livraison",
        image: "https://via.placeholder.com/150/9966CC/FFFFFF?Text=Mission5",
        resumeCourt: "Aidez un marchand.",
        resumeComplet:
          "Un marchand local a besoin d'aide pour livrer un colis important à un village voisin. Le chemin peut être dangereux, parsemé de bandits ou de bêtes sauvages, alors soyez prudent et préparez-vous au combat. La récompense en vaut la peine.",
        xp: 15,
      },
      {
        id: "m2-6",
        titre: "Entraînement au combat",
        image: "https://via.placeholder.com/150/FF9900/FFFFFF?Text=Mission6",
        resumeCourt: "Améliorez vos techniques.",
        resumeComplet:
          "Rendez-vous au camp d'entraînement et parlez au maître d'armes. Complétez une série d'épreuves pour parfaire vos compétences de combat, apprendre de nouvelles techniques et comprendre les combos dévastateurs de votre classe.",
        xp: 30,
      },
    ],
  },
  // Ajoutez d'autres paliers jusqu'au niveau 50.
  {
    id: "palier3", // Ajout d'un palier intermédiaire pour tester la progression
    nom: "Palier 21-30",
    descriptionNiveau: "Niveaux 21 à 30",
    seuilXPNextPalier: 70,
    missions: [
      {
        id: "m3-1",
        titre: "Maîtrise intermédiaire",
        image: "https://via.placeholder.com/150/FFAA00/FFFFFF?Text=Mission31",
        resumeCourt: "Perfectionnez vos compétences.",
        resumeComplet:
          "Apprenez à maîtriser des techniques plus avancées et combinez-les efficacement dans des situations de combat variées.",
        xp: 40,
      },
      {
        id: "m3-2",
        titre: "Exploration des ruines",
        image: "https://via.placeholder.com/150/BBAA00/FFFFFF?Text=Mission32",
        resumeCourt: "Découvrez des ruines anciennes.",
        resumeComplet:
          "Explorez les ruines oubliées de la civilisation perdue et découvrez leurs secrets bien gardés.",
        xp: 50,
      },
    ],
  },
  {
    id: "palier4", // Ajout d'un palier intermédiaire pour tester la progression
    nom: "Palier 31-40",
    descriptionNiveau: "Niveaux 31 à 40",
    seuilXPNextPalier: 70,
    missions: [
      {
        id: "m4-1",
        titre: "Quête de l'artefact",
        image: "https://via.placeholder.com/150/AA5500/FFFFFF?Text=Mission41",
        resumeCourt: "Retrouvez un artefact légendaire.",
        resumeComplet:
          "Partez à la recherche d'un puissant artefact capable de changer le cours de l'histoire.",
        xp: 60,
      },
      {
        id: "m4-2",
        titre: "Alliance stratégique",
        image: "https://via.placeholder.com/150/55AA00/FFFFFF?Text=Mission42",
        resumeCourt: "Formez une alliance avec une faction.",
        resumeComplet:
          "Négociez une alliance avec l'une des factions influentes du monde pour préparer les défis à venir.",
        xp: 70,
      },
    ],
  },
  {
    id: "palierFinal",
    nom: "Palier 41-50",
    descriptionNiveau: "Niveaux 41 à 50",
    seuilXPNextPalier: 70,
    missions: [
      {
        id: "mf-1",
        titre: "Maîtrise du combat",
        image: "https://via.placeholder.com/150/00FFFF/000000?Text=MissionFin1",
        resumeCourt: "Prouvez votre valeur.",
        resumeComplet:
          "Venez à bout d'un boss de haut niveau, comme le Dragon Cochon, pour montrer votre maîtrise des arcanes du combat et votre préparation pour les défis ultimes. Ce combat exigera une parfaite connaissance de votre classe et une bonne coordination si vous êtes en groupe.",
        xp: 100,
      },
      // Correction des IDs dupliqués
      {
        id: "mf-2",
        titre: "Quête épique",
        image: "https://via.placeholder.com/150/FF6600/FFFFFF?Text=MissionFin2",
        resumeCourt: "Terminez la quête finale.",
        resumeComplet:
          "Participez à la quête finale de l'extension actuelle. Cette quête vous plongera dans une histoire riche et vous mettra face à des choix cruciaux. Vos décisions influenceront le monde de NexusWakfu et détermineront votre place dans l'histoire.",
        xp: 50,
      },
      {
        id: "mf-3", // ID corrigé
        titre: "Le choix ultime",
        image: "https://via.placeholder.com/150/FF6600/FFFFFF?Text=MissionFin3",
        resumeCourt: "Prenez une décision qui changera tout.",
        resumeComplet:
          "Faites face à un dilemme moral qui aura des conséquences majeures sur le monde de NexusWakfu. Votre choix définira l'avenir de nombreuses factions.",
        xp: 50,
      },
      {
        id: "mf-4", // ID corrigé
        titre: "L'héritage des anciens",
        image: "https://via.placeholder.com/150/FF6600/FFFFFF?Text=MissionFin4",
        resumeCourt: "Découvrez le secret des anciens.",
        resumeComplet:
          "Percez le mystère des anciens bâtisseurs et intégrez leur savoir à votre arsenal pour devenir une légende vivante.",
        xp: 50,
      },
      {
        id: "mf-5", // ID corrigé
        titre: "L'ultime défi",
        image: "https://via.placeholder.com/150/FF6600/FFFFFF?Text=MissionFin5",
        resumeCourt: "Affrontez le boss final.",
        resumeComplet:
          "Confrontez-vous à l'entité la plus puissante du jeu. Cette bataille mettra vos compétences à rude épreuve et marquera l'aboutissement de votre parcours.",
        xp: 50,
      },
    ],
  },
];
---

<Layout title="Guide de Progression NexusWakfu">
  <div class="guide-nexuswakfu">
    <h1>Guide de Progression Interactif</h1>

    <div id="paliers-container">
      <!-- Les paliers seront injectés ici par JavaScript -->
    </div>

    <div
      id="message-felicitations"
      class="hidden"
      style="text-align: center; margin-top: 30px; padding: 25px; background-color: #e6ffed; border: 2px solid #34d399; border-radius: 8px; color: #065f46;"
    >
      <h2>🎉 Félicitations ! 🎉</h2>
      <p>
        Vous avez brillamment complété tous les paliers du guide ! Vous êtes un
        véritable expert de NexusWakfu !
      </p>
    </div>
  </div>

  <script define:vars={{ tiersData }}>
    const paliersContainer = document.getElementById("paliers-container");
    const messageFelicitations = document.getElementById(
      "message-felicitations"
    );
    let palierActuelIndex = 0;
    let elementsPaliersDom = []; // Pour stocker les éléments DOM des paliers
    let passageEnCours = false; // Variable pour suivre si un passage est en cours
    let timerPassage = null; // Pour stocker l'ID du timer de passage

    function creerCarteMission(mission, callbackValidation) {
      const carte = document.createElement("div");
      carte.className = "mission-carte";
      carte.dataset.missionId = mission.id;

      const img = document.createElement("img");
      img.src = mission.image;
      img.alt = mission.titre;
      carte.appendChild(img);

      const titre = document.createElement("h3");
      titre.textContent = mission.titre;
      carte.appendChild(titre);

      const resumeCourtEl = document.createElement("p");
      resumeCourtEl.className = "resume-court";
      resumeCourtEl.textContent = mission.resumeCourt;
      carte.appendChild(resumeCourtEl);

      const resumeCompletEl = document.createElement("p");
      resumeCompletEl.className = "resume-complet hidden";
      // Assurez-vous que mission.resumeComplet contient suffisamment de texte.
      resumeCompletEl.textContent = mission.resumeComplet;
      carte.appendChild(resumeCompletEl);

      const btnVoirPlus = document.createElement("button");
      btnVoirPlus.className = "btn-voir-plus";
      btnVoirPlus.textContent = "Voir plus";
      btnVoirPlus.onclick = () => {
        resumeCourtEl.classList.toggle("hidden");
        resumeCompletEl.classList.toggle("hidden");
        btnVoirPlus.textContent = resumeCompletEl.classList.contains("hidden")
          ? "Voir plus"
          : "Voir moins";
      };
      carte.appendChild(btnVoirPlus);

      const btnValider = document.createElement("button");
      btnValider.className = "btn-valider";
      btnValider.textContent = "Valider";
      btnValider.onclick = () => {
        if (!carte.classList.contains("validee")) {
          carte.classList.add("validee");
          btnValider.textContent = "Validée ✔";
          btnValider.disabled = true;
          btnVoirPlus.disabled = true; // Optionnel: désactiver aussi voir plus
          callbackValidation(mission.xp);
        }
      };
      carte.appendChild(btnValider);

      return carte;
    }

    function afficherPalier(index) {
      // Vérifier si l'index est valide
      if (index < 0 || index > tiersData.length) {
        console.error("Index de palier invalide:", index);
        return;
      }

      // Réinitialiser l'état de passage
      passageEnCours = false;
      if (timerPassage) {
        clearTimeout(timerPassage);
        timerPassage = null;
      }

      // Cacher tous les paliers précédemment affichés
      elementsPaliersDom.forEach((element) => {
        if (element) {
          element.style.display = "none";
        }
      });

      // Si le palier actuel a déjà été rendu, le montrer et sortir
      if (elementsPaliersDom[index]) {
        elementsPaliersDom[index].style.display = "block";
        return;
      }

      if (index >= tiersData.length) {
        // Tous les paliers sont complétés
        messageFelicitations.classList.remove("hidden");
        return;
      }

      const palierData = tiersData[index];
      const divPalier = document.createElement("div");
      divPalier.className = "palier";
      divPalier.dataset.palierId = palierData.id;
      elementsPaliersDom[index] = divPalier;

      // Ajouter un en-tête avec le numéro du palier pour faciliter le débogage
      const debugInfo = document.createElement("div");
      debugInfo.className = "debug-info";
      debugInfo.textContent = `Palier actuel: ${index + 1} sur ${tiersData.length}`;
      debugInfo.style.fontSize = "0.8em";
      debugInfo.style.color = "#888";
      debugInfo.style.marginBottom = "5px";
      divPalier.appendChild(debugInfo);

      const titrePalier = document.createElement("h2");
      titrePalier.textContent = `${palierData.nom} (${palierData.descriptionNiveau})`;
      divPalier.appendChild(titrePalier);

      const barreProgressionContainer = document.createElement("div");
      barreProgressionContainer.className = "barre-progression-container";
      const barreProgression = document.createElement("div");
      barreProgression.className = "barre-progression";
      barreProgression.style.width = "0%";
      barreProgressionContainer.appendChild(barreProgression);
      divPalier.appendChild(barreProgressionContainer);

      const texteProgression = document.createElement("p");
      texteProgression.className = "texte-progression";
      texteProgression.textContent = "Progression: 0%";
      divPalier.appendChild(texteProgression);

      const missionsContainer = document.createElement("div");
      missionsContainer.className = "missions-grille";
      divPalier.appendChild(missionsContainer);

      let xpAccumule = 0;
      const xpTotalPalier = palierData.missions.reduce(
        (total, m) => total + m.xp,
        0
      );

      palierData.missions.forEach((mission) => {
        const carteMission = creerCarteMission(mission, (xpGagnee) => {
          xpAccumule += xpGagnee;
          const pourcentage =
            xpTotalPalier > 0
              ? Math.min(100, (xpAccumule / xpTotalPalier) * 100)
              : 0;
          barreProgression.style.width = `${pourcentage}%`;
          texteProgression.textContent = `Progression: ${Math.round(pourcentage)}%`;

          // Vérifier si la progression est suffisante pour débloquer le prochain palier
          // et s'assurer qu'un passage n'est pas déjà programmé
          if (pourcentage >= palierData.seuilXPNextPalier && !passageEnCours) {
            // Marquer qu'un passage est en cours
            passageEnCours = true;

            // Supprimer tout ancien message de déblocage
            const ancienMessage = divPalier.querySelector(".message-deblocage");
            if (ancienMessage) {
              divPalier.removeChild(ancienMessage);
            }

            // Afficher un message pour informer l'utilisateur
            const msgDeblocage = document.createElement("div");
            msgDeblocage.className = "message-deblocage";
            msgDeblocage.textContent = `Vous avez débloqué le palier suivant ! Chargement dans 3 secondes...`;
            msgDeblocage.style.color = "var(--couleur-succes)";
            msgDeblocage.style.fontWeight = "bold";
            msgDeblocage.style.marginTop = "10px";
            msgDeblocage.style.textAlign = "center";

            divPalier.appendChild(msgDeblocage);

            // Annuler tout timer précédent
            if (timerPassage) {
              clearTimeout(timerPassage);
            }

            // Créer un nouveau timer
            timerPassage = setTimeout(() => {
              // Vérifier que nous sommes toujours sur le même palier
              if (palierActuelIndex === index) {
                passerAuPalierSuivant();
              }
            }, 3000);
          }
        });
        missionsContainer.appendChild(carteMission);
      });

      paliersContainer.appendChild(divPalier);

      // Log de débogage
      console.log(
        `Palier ${index + 1}/${tiersData.length} affiché: ${palierData.nom}`
      );
    }

    function passerAuPalierSuivant() {
      // Réinitialiser les variables de contrôle
      passageEnCours = false;
      if (timerPassage) {
        clearTimeout(timerPassage);
        timerPassage = null;
      }

      // S'assurer qu'on ne dépasse pas le nombre de paliers disponibles
      if (palierActuelIndex < tiersData.length - 1) {
        console.log(
          `Passage du palier ${palierActuelIndex + 1} au palier ${palierActuelIndex + 2}`
        );
        palierActuelIndex++;
        afficherPalier(palierActuelIndex);
      } else {
        // Si c'est le dernier palier, afficher le message de félicitations
        console.log("Dernier palier complété, affichage des félicitations");
        messageFelicitations.classList.remove("hidden");
        // Cacher le dernier palier
        if (elementsPaliersDom[palierActuelIndex]) {
          elementsPaliersDom[palierActuelIndex].style.display = "none";
        }
      }
    }

    // Affichage initial du premier palier
    afficherPalier(palierActuelIndex);
  </script>

  <style is:global>
    :root {
      --couleur-principale: #4a90e2; /* Bleu Nexus */
      --couleur-succes: #50e3c2; /* Vert menthe succès */
      --couleur-texte: #333;
      --couleur-fond-carte: #ffffff;
      --couleur-fond-page: #f4f7f6;
      --ombre-carte: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background-color: var(--couleur-fond-page);
      color: var(--couleur-texte);
      line-height: 1.6;
    }

    .guide-nexuswakfu {
      max-width: 1000px;
      margin: 20px auto;
      padding: 20px;
      background-color: var(--couleur-fond-carte);
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
    }

    .guide-nexuswakfu h1 {
      text-align: center;
      color: var(--couleur-principale);
      margin-bottom: 30px;
    }

    .palier {
      margin-bottom: 40px;
      padding: 20px;
      background-color: #fff;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      box-shadow: var(--ombre-carte);
    }

    .palier h2 {
      color: var(--couleur-principale);
      border-bottom: 2px solid var(--couleur-principale);
      padding-bottom: 10px;
      margin-top: 0;
    }

    .barre-progression-container {
      width: 100%;
      background-color: #e0e0e0;
      border-radius: 25px;
      margin: 15px 0;
      height: 25px;
      overflow: hidden;
    }

    .barre-progression {
      height: 100%;
      width: 0%;
      background-color: var(--couleur-succes);
      border-radius: 25px;
      transition: width 0.6s ease-in-out;
      text-align: center;
      color: white;
      font-weight: bold;
      line-height: 25px; /* Pour centrer le texte si on en met */
    }

    .texte-progression {
      text-align: right;
      font-size: 0.9em;
      color: #555;
      margin-top: 5px;
    }

    .missions-grille {
      display: grid;
      /* Augmentation de la largeur minimale pour que les cartes prennent plus de place */
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    /* Pour les écrans larges, nous visons moins de cartes par ligne pour qu'elles soient plus larges. */
    @media (min-width: 992px) {
      /* S'aligne sur la largeur max du conteneur .guide-nexuswakfu */
      .missions-grille {
        /* Réduction du nombre de colonnes pour des cartes plus larges */
        grid-template-columns: repeat(3, 1fr);
      }
    }

    .mission-carte {
      background-color: var(--couleur-fond-carte);
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      box-shadow: var(--ombre-carte);
      transition:
        transform 0.2s ease-out,
        box-shadow 0.2s ease-out;
      display: flex;
      flex-direction: column;
    }

    .mission-carte:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
    }

    .mission-carte.validee {
      background-color: #f0fff4; /* Vert très clair */
      opacity: 0.75;
      border-left: 5px solid var(--couleur-succes);
    }

    .mission-carte.validee:hover {
      transform: none;
      box-shadow: var(--ombre-carte);
    }

    .mission-carte img {
      width: 100%;
      height: 120px; /* Ajusté légèrement pour des cartes plus petites */
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 10px;
    }

    .mission-carte h3 {
      margin-top: 0;
      margin-bottom: 8px;
      font-size: 1.1em; /* Légèrement réduit pour cartes plus petites */
      color: #333;
    }

    .mission-carte p {
      font-size: 0.9em; /* Légèrement réduit */
      margin-bottom: 12px;
      flex-grow: 1;
    }
    .mission-carte .resume-complet {
      font-size: 0.85em; /* Légèrement réduit */
      color: #555;
    }

    .mission-carte button {
      padding: 8px 12px; /* Ajusté pour des cartes plus petites */
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.2s ease;
      margin-top: 5px;
    }

    .mission-carte .btn-voir-plus {
      background-color: #e0e0e0;
      color: #333;
      margin-right: 5px; /* Ajustement pour espacement si les boutons sont sur la même ligne */
    }
    .mission-carte .btn-voir-plus:hover {
      background-color: #c7c7c7;
    }

    .mission-carte .btn-valider {
      background-color: var(--couleur-principale);
      color: white;
    }
    .mission-carte .btn-valider:hover {
      background-color: #3a7bc8;
    }
    .mission-carte .btn-valider:disabled {
      background-color: var(--couleur-succes);
      color: #065f46;
      cursor: not-allowed;
    }
    .mission-carte .btn-valider:disabled:hover {
      background-color: var(--couleur-succes);
    }

    .hidden {
      display: none !important;
    }

    /* Style pour le message de déblocage */
    .message-deblocage {
      padding: 10px;
      background-color: rgba(80, 227, 194, 0.1);
      border-radius: 5px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0% {
        opacity: 0.6;
      }
      50% {
        opacity: 1;
      }
      100% {
        opacity: 0.6;
      }
    }

    /* Style pour l'info de débogage */
    .debug-info {
      background-color: #f5f5f5;
      padding: 5px;
      border-radius: 3px;
      margin-bottom: 10px;
    }
  </style>
</Layout>
